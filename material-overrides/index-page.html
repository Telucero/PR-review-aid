{% extends "main.html" %}

{% block content %}

{% macro find_active_page(element) %}
  {% for nav_item in element %}
    {% if nav_item.active %}
      {% if nav_item.is_section %}
        <!-- continue to find active page -->
        {{ find_active_page(nav_item.children) }}
      {% else %}
        <!-- render subsection content -->
        {% if nav_item.is_page %}
          <h1 class="subsection-title">{{ nav_item.parent.title }}</h1>
          <div class="subsection-wrapper">
            <!-- Start building out the structure for index pages here!  -->
            <!-- Leaving blank for now, if we want same structure as moonbeam index pages we can copy pasta it over -->
          </div>
        {% endif %}
      {% endif %}
    {% endif %}
  {% endfor %}

  {% set most_nested_active_element = None %}
  {% if element.active == True %}
    {{ element }}
    {% set most_nested_active_element = element %}
  {% endif %}

  {% if element.active and element.children %}
    {% for child in element.children %}
      {% set nested_active_element = find_active_page(child) %}
      {% if nested_active_element != none %}
        {% set most_nested_active_element = nested_active_element %}
      {% endif %}
    {% endfor %}
  {% endif %}
{% endmacro %}

<div class="subsection-page">
    {% if nav|length>1 %}
      {% for nav_item in nav %}
        {% if nav_item.is_section and nav_item.active %}
          {{ find_active_page(nav_item.children) }}
        {% endif %}
      {% endfor %}
    {% endif %}
</div>
{% endblock %}